<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Angular Http 400 에러 처리하기 (Observabel 데이터 처리)" /><meta name="author" content="Yeonseo Nam" /><meta property="og:locale" content="en_US" /><meta name="description" content="서버에 요청을 보낼 시, 발행할 수 있는 에러는 여러 가지가 있습니다. 회원가입을 하는데 서버에서 필요한 데이터는 ID, password, email인데 사용자가 ID와 password만 적고 email이 귀찮아서 적지 않는다면 에러를 뱉어내죠. 사용자 입장에선 화면이 아무것도 변하지 않고 회원가입도 안 되기 때문에 무엇이 잘못된지 인지하지 못합니다. 또, 게시물을 작성할 때도 같습니다. 제목과 내용이 필요한데, 제목을 적지 않았을 경우 적절한 조치를 취해주지 않으면 사용자는 무엇을 개선해야할지 정확히 모르기 때문에 제목을 입력하라고 알려주어거나 코드 상에서 기본값을 정해주어야 하죠." /><meta property="og:description" content="서버에 요청을 보낼 시, 발행할 수 있는 에러는 여러 가지가 있습니다. 회원가입을 하는데 서버에서 필요한 데이터는 ID, password, email인데 사용자가 ID와 password만 적고 email이 귀찮아서 적지 않는다면 에러를 뱉어내죠. 사용자 입장에선 화면이 아무것도 변하지 않고 회원가입도 안 되기 때문에 무엇이 잘못된지 인지하지 못합니다. 또, 게시물을 작성할 때도 같습니다. 제목과 내용이 필요한데, 제목을 적지 않았을 경우 적절한 조치를 취해주지 않으면 사용자는 무엇을 개선해야할지 정확히 모르기 때문에 제목을 입력하라고 알려주어거나 코드 상에서 기본값을 정해주어야 하죠." /><link rel="canonical" href="https://yeonseo.github.io/posts/Angular-Observable-post/" /><meta property="og:url" content="https://yeonseo.github.io/posts/Angular-Observable-post/" /><meta property="og:site_name" content="우당탕탕 벌크업만 성공한 개발자" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-06-12T19:34:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Angular Http 400 에러 처리하기 (Observabel 데이터 처리)" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Yeonseo Nam"},"dateModified":"2022-03-28T09:07:56+09:00","datePublished":"2020-06-12T19:34:00+09:00","description":"서버에 요청을 보낼 시, 발행할 수 있는 에러는 여러 가지가 있습니다. 회원가입을 하는데 서버에서 필요한 데이터는 ID, password, email인데 사용자가 ID와 password만 적고 email이 귀찮아서 적지 않는다면 에러를 뱉어내죠. 사용자 입장에선 화면이 아무것도 변하지 않고 회원가입도 안 되기 때문에 무엇이 잘못된지 인지하지 못합니다. 또, 게시물을 작성할 때도 같습니다. 제목과 내용이 필요한데, 제목을 적지 않았을 경우 적절한 조치를 취해주지 않으면 사용자는 무엇을 개선해야할지 정확히 모르기 때문에 제목을 입력하라고 알려주어거나 코드 상에서 기본값을 정해주어야 하죠.","headline":"Angular Http 400 에러 처리하기 (Observabel 데이터 처리)","mainEntityOfPage":{"@type":"WebPage","@id":"https://yeonseo.github.io/posts/Angular-Observable-post/"},"url":"https://yeonseo.github.io/posts/Angular-Observable-post/"}</script><title>Angular Http 400 에러 처리하기 (Observabel 데이터 처리) | 우당탕탕 벌크업만 성공한 개발자</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="우당탕탕 벌크업만 성공한 개발자"><meta name="application-name" content="우당탕탕 벌크업만 성공한 개발자"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/profile.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">우당탕탕 벌크업만 성공한 개발자</a></div><div class="site-subtitle font-italic">근성보다 근질이 좋아지는 5년차 개발자</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME 🤗</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/yeonseo" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://www.instagram.com/bboby_ggggg" aria-label="instagram" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-instagram"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['yeonseo9105','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Angular Http 400 에러 처리하기 (Observabel 데이터 처리)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Angular Http 400 에러 처리하기 (Observabel 데이터 처리)</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Yeonseo Nam </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Jun 12, 2020, 7:34 PM +0900" prep="on" > Jun 12, 2020 <i class="unloaded">2020-06-12T19:34:00+09:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Mar 28, 2022, 9:07 AM +0900" prefix="Updated " > Mar 28, 2022 <i class="unloaded">2022-03-28T09:07:56+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1406 words">7 min</span></div></div><div class="post-content"><p>서버에 요청을 보낼 시, 발행할 수 있는 에러는 여러 가지가 있습니다. 회원가입을 하는데 서버에서 필요한 데이터는 ID, password, email인데 사용자가 ID와 password만 적고 email이 귀찮아서 적지 않는다면 에러를 뱉어내죠. 사용자 입장에선 화면이 아무것도 변하지 않고 회원가입도 안 되기 때문에 무엇이 잘못된지 인지하지 못합니다. 또, 게시물을 작성할 때도 같습니다. 제목과 내용이 필요한데, 제목을 적지 않았을 경우 적절한 조치를 취해주지 않으면 사용자는 무엇을 개선해야할지 정확히 모르기 때문에 제목을 입력하라고 알려주어거나 코드 상에서 기본값을 정해주어야 하죠.</p><p>가입 좌절 이미지</p><p>하지만 이것들은 form 검증에서 이루어지는 일이고, 요청에 대한 return에서 바로 해결해야 할 필요성이 있습니다. 에러를 개발자가 핸들링할 수 있다면 자체 로직으로 에러를 발생시키지 않으면서 문제를 처리할 수 있습니다.</p><h2 id="참고">참고</h2><blockquote><p>MDN HTTP 상태 코드 https://developer.mozilla.org/ko/docs/Web/HTTP/Status</p></blockquote><p><br /><br /><br /><br /><br /></p><hr /><ul><li>Development Env.<li>post date : 2020. 06. 12<li>OS : macOS Catalina 64bit, Windows 10 64bit<li>Node : ‘’<li>Angular : ‘’<li>WebStorm : 2017.2.6<li>JRE: 1.8.0_152-release-915-b12 amd64<li>JVM: OpenJDK 64-Bit Server VM by JetBrains s.r.o</ul><hr /><p>에러가 발생하면, Requst로 에러 정보가 담겨옵니다. 이 정보는 개발자 도구 창에서 볼 수 있습니다. 에러 코드에 대해서 컨트롤 하는 것은 초반부터 하는 것은 권장되지 않고, 개발이 완성될 즘에 처리를 합니다. 저는 게시판과 회원가입 기능이 거의 완성되었기 때문에 400, 403 에러에 대해서 Interceptor에서 처리를 할 수 있도록 구현하기로 했습니다.</p><h1 id="interceptor-수정">Interceptor 수정</h1><p>아래와 같이 Interceptor에서 error를 처리하는 부분에 status(상태코드 값이 들어옴)가 400, 403인 경우에 제가 커스텀한 message가 return 되도록 처리하고 싶었습니다. 그러다 오류가 발생했는데, 이유는 전송하려는 데이터가 Observable이란 클래스 형식이 아니기 때문입니다.</p><div class="language-ts highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="k">return</span> <span class="nx">next</span><span class="p">.</span><span class="nf">handle</span><span class="p">(</span><span class="nx">req</span><span class="p">).</span><span class="nf">pipe</span><span class="p">(</span>
      <span class="nf">map</span><span class="p">((</span><span class="nx">event</span><span class="p">:</span> <span class="nx">HttpEvent</span><span class="o">&lt;</span><span class="kr">any</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">event</span> <span class="k">instanceof</span> <span class="nx">HttpResponse</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Interceptor Event---&gt;&gt;&gt;</span><span class="dl">'</span><span class="p">,</span> <span class="nx">event</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">event</span><span class="p">;</span>
      <span class="p">}),</span>
      <span class="nf">catchError</span><span class="p">(</span><span class="nx">error</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">error_data</span> <span class="o">=</span> <span class="p">{</span>
          <span class="na">error</span> <span class="p">:</span> <span class="nx">error</span><span class="p">,</span>
          <span class="na">reason</span><span class="p">:</span> <span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">error</span><span class="p">.</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">error</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">reason</span> <span class="p">?</span> <span class="nx">error</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">reason</span> <span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
          <span class="na">status</span><span class="p">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">status</span>
        <span class="p">};</span>
        <span class="c1">// error_m = error &amp;&amp; error.error &amp;&amp; error.error.reason ? error.error.reason : '';</span>
        <span class="c1">// status_m = error.status;</span>
        <span class="c1">// messeage = error.error.error.message;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Interceptor error---&gt;&gt;&gt;</span><span class="dl">'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">error_data</span> <span class="p">);</span>

        <span class="k">if </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">error_data</span><span class="p">[</span><span class="dl">'</span><span class="s1">status</span><span class="dl">'</span><span class="p">]</span> <span class="o">===</span> <span class="mi">400</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">잘못된 요청입니다 에러</span><span class="dl">'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">error_data</span> <span class="p">);</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">errorCostom</span> <span class="o">=</span> <span class="p">{</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">잘못된 요청입니다. 입력칸을 다시 확인해주세요. </span><span class="se">\n</span><span class="s1">계속 오류가 발생될 경우, 관리자에게 문의바랍니다.</span><span class="dl">'</span><span class="p">};</span>
          <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">errorCostom</span><span class="p">;</span> <span class="c1">// &lt;&lt;&lt;&lt;&lt;----- 이렇게 보내면 안됩니다~</span>
        <span class="p">}</span>

        <span class="k">if </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">error_data</span><span class="p">[</span><span class="dl">'</span><span class="s1">status</span><span class="dl">'</span><span class="p">]</span> <span class="o">===</span> <span class="mi">403</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">권한이 없습니다 에러</span><span class="dl">'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">error_data</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="nf">throwError</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
      <span class="p">})</span>
    <span class="p">);</span>
</pre></table></code></div></div><p>아래와 같은 에러 메세지를 만났습니다. 매번 새로운 에러 💫 이렇게 또 알아가는거지,,,</p><blockquote><p>error TS2345: Argument of type ‘(error: any) =&gt; {}’ is not assignable to parameter of type ‘(err: any, caught: Observable&lt;HttpEvent<any>&gt;) =&gt; ObservableInput<any>'. Type '{}' is not assignable to type 'ObservableInput<any>'.</any></any></any></p></blockquote><p>데이터 흐름은 Observable이라는 클래스가 가진 형태로 전송이 되어야 하는데, 보내려고 하는 {‘message’ : ‘!@#$’} 객체 형태는 적합하지 않다고 합니다.</p><h1 id="해결">해결!</h1><div class="language-ts highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="kd">class</span> <span class="nc">HttpInterceptorService</span> <span class="k">implements</span> <span class="nx">HttpInterceptor</span> <span class="p">{</span>

  <span class="k">private</span> <span class="nx">globalToken</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">EmptyToken</span><span class="dl">'</span><span class="p">;</span>
  <span class="k">public</span> <span class="nx">error_data</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="k">public</span> <span class="nx">errorCostom</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>

  <span class="nf">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">injector</span><span class="p">:</span> <span class="nx">Injector</span><span class="p">,</span>
              <span class="k">private</span> <span class="nx">requestService</span><span class="p">:</span> <span class="nx">RequestService</span><span class="p">,</span>
              <span class="k">private</span> <span class="nx">authService</span><span class="p">:</span> <span class="nx">AuthenticationService</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">}</span>

  <span class="nf">intercept</span><span class="p">(</span><span class="nx">req</span><span class="p">:</span> <span class="nx">HttpRequest</span><span class="o">&lt;</span><span class="kr">any</span><span class="o">&gt;</span><span class="p">,</span> <span class="nx">next</span><span class="p">:</span> <span class="nx">HttpHandler</span><span class="p">):</span> <span class="nx">Observable</span><span class="o">&lt;</span><span class="nx">HttpEvent</span><span class="o">&lt;</span><span class="kr">any</span><span class="o">&gt;&gt;</span> <span class="p">{</span>
    <span class="c1">// const token: string = localStorage.getItem('token');</span>
    <span class="kd">const</span> <span class="na">currentUser</span><span class="p">:</span> <span class="kr">string</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="nx">localStorage</span><span class="p">.</span><span class="nf">getItem</span><span class="p">(</span><span class="dl">'</span><span class="s1">currentUser</span><span class="dl">'</span><span class="p">));</span>
    <span class="k">if </span><span class="p">(</span><span class="nx">currentUser</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">req</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nf">clone</span><span class="p">({</span><span class="na">headers</span><span class="p">:</span> <span class="nx">req</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">Authorization</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">Bearer </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">currentUser</span><span class="p">[</span><span class="dl">'</span><span class="s1">token</span><span class="dl">'</span><span class="p">])});</span>
    <span class="p">}</span>
    <span class="k">if </span><span class="p">(</span><span class="o">!</span><span class="nx">req</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nf">has</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">req</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nf">clone</span><span class="p">({</span><span class="na">headers</span><span class="p">:</span> <span class="nx">req</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">)});</span>
    <span class="p">}</span>
    <span class="nx">req</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nf">clone</span><span class="p">({</span><span class="na">headers</span><span class="p">:</span> <span class="nx">req</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">Accept</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">)});</span>

    <span class="k">return</span> <span class="nx">next</span><span class="p">.</span><span class="nf">handle</span><span class="p">(</span><span class="nx">req</span><span class="p">).</span><span class="nf">pipe</span><span class="p">(</span>
      <span class="nf">retry</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
      <span class="nf">map</span><span class="p">((</span><span class="na">event</span><span class="p">:</span> <span class="nx">HttpEvent</span><span class="o">&lt;</span><span class="kr">any</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">event</span> <span class="k">instanceof</span> <span class="nx">HttpResponse</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Interceptor Event---&gt;&gt;&gt;</span><span class="dl">'</span><span class="p">,</span> <span class="nx">event</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="nx">event</span><span class="p">;</span>
      <span class="p">}),</span>
      <span class="nf">catchError</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">handleError</span><span class="p">)</span>
    <span class="p">);</span>
  <span class="p">}</span>


  <span class="nf">handleError</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">error_data</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">error</span><span class="p">:</span> <span class="nx">error</span><span class="p">,</span>
      <span class="na">reason</span><span class="p">:</span> <span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">error</span><span class="p">.</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">error</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">reason</span> <span class="p">?</span> <span class="nx">error</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">reason</span> <span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
      <span class="na">status</span><span class="p">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">status</span>
    <span class="p">};</span>
    <span class="c1">// error_m = error &amp;&amp; error.error &amp;&amp; error.error.reason ? error.error.reason : '';</span>
    <span class="c1">// status_m = error.status;</span>
    <span class="c1">// messeage = error.error.error.message;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Interceptor error---&gt;&gt;&gt;</span><span class="dl">'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">error_data</span><span class="p">);</span>

    <span class="k">if </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">error_data</span><span class="p">[</span><span class="dl">'</span><span class="s1">status</span><span class="dl">'</span><span class="p">]</span> <span class="o">===</span> <span class="mi">400</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">errorCostom</span> <span class="o">=</span>
        <span class="s2">`잘못된 요청입니다. 입력칸을 다시 확인해주세요.
        계속 오류가 발생될 경우, 관리자에게 문의바랍니다.
      \n code : </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">error_data</span><span class="p">[</span><span class="dl">'</span><span class="s1">status</span><span class="dl">'</span><span class="p">]}</span><span class="s2">`</span><span class="p">;</span>
      <span class="c1">// return this.errorCostom; -&gt; Observable ㅠㅠ</span>
    <span class="p">}</span>
    <span class="k">if </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">error_data</span><span class="p">[</span><span class="dl">'</span><span class="s1">status</span><span class="dl">'</span><span class="p">]</span> <span class="o">===</span> <span class="mi">403</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">errorCostom</span> <span class="o">=</span>
        <span class="s2">`접근 권한이 없습니다. 권한 변경을 원하시면 관리자에게 문의바랍니다.
      \n code : </span><span class="p">${</span><span class="k">this</span><span class="p">.</span><span class="nx">error_data</span><span class="p">[</span><span class="dl">'</span><span class="s1">status</span><span class="dl">'</span><span class="p">]}</span><span class="s2">`</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">errorCostom</span><span class="p">[</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">]</span> <span class="o">!==</span> <span class="dl">''</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nf">throwError</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nf">handleErrorRef</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">errorMessage</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">error_data</span> <span class="o">=</span> <span class="p">{</span>
      <span class="na">error</span><span class="p">:</span> <span class="nx">error</span><span class="p">,</span>
      <span class="na">reason</span><span class="p">:</span> <span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">error</span><span class="p">.</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">error</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">reason</span> <span class="p">?</span> <span class="nx">error</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">reason</span> <span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
      <span class="na">status</span><span class="p">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">status</span>
    <span class="p">};</span>

    <span class="k">if </span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">error</span> <span class="k">instanceof</span> <span class="nx">ErrorEvent</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// client-side error</span>
      <span class="nx">errorMessage</span> <span class="o">=</span> <span class="s2">`Error: </span><span class="p">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// server-side error</span>
      <span class="nx">errorMessage</span> <span class="o">=</span> <span class="s2">`Error Code: </span><span class="p">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">status</span><span class="p">}</span><span class="s2">\nMessage: </span><span class="p">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nb">window</span><span class="p">.</span><span class="nf">alert</span><span class="p">(</span><span class="nx">errorMessage</span><span class="p">);</span>
    <span class="k">return</span> <span class="nf">throwError</span><span class="p">(</span><span class="nx">errorMessage</span><span class="p">);</span>
  <span class="p">}</span>

<span class="p">}</span>
</pre></table></code></div></div><p>위처럼 전달하려는 에러 정보가 어떤 메세지로 나타났으면 좋겠는지 작성을 하고, 그 내용을 message라는 항목에 넣어서 에러자체를 전달해주어야 합니다. 👌</p><h2 id="참조">참조</h2><blockquote><p>RxJava - Observable이란? https://penguin-story.tistory.com/10</p></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/tutorial/'>Tutorial</a>, <a href='/categories/django-angular/'>Django & Angular</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/angular/" class="post-tag no-text-decoration" >Angular</a> <a href="/tags/typescript/" class="post-tag no-text-decoration" >TypeScript</a> <a href="/tags/observabel/" class="post-tag no-text-decoration" >Observabel</a> <a href="/tags/frontend/" class="post-tag no-text-decoration" >Frontend</a> <a href="/tags/web/" class="post-tag no-text-decoration" >Web</a> <a href="/tags/til/" class="post-tag no-text-decoration" >TIL</a> <a href="/tags/today-i-leaned/" class="post-tag no-text-decoration" >Today I Leaned</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Angular Http 400 에러 처리하기 (Observabel 데이터 처리) - 우당탕탕 벌크업만 성공한 개발자&url=https://yeonseo.github.io/posts/Angular-Observable-post/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Angular Http 400 에러 처리하기 (Observabel 데이터 처리) - 우당탕탕 벌크업만 성공한 개발자&u=https://yeonseo.github.io/posts/Angular-Observable-post/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Angular Http 400 에러 처리하기 (Observabel 데이터 처리) - 우당탕탕 벌크업만 성공한 개발자&url=https://yeonseo.github.io/posts/Angular-Observable-post/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Kubernetes-Ingress-413-post/">Kubernetes Ingress 413 오류 해결 과정과 최적화 전략</a><li><a href="/posts/Developer-mindset-post/">Vue 프로젝트 회고 - 처음부터 끝까지의 경험과 교훈</a><li><a href="/posts/Developer-Frontend-Vue-post/">개발자의 소통에 대한 고찰 - 기획과 개발 사이에서 길을 찾다</a><li><a href="/posts/React-State-Manage-post/">React에서의 State 개념 정리</a><li><a href="/posts/React-StrictMode-post/">React.StrictMode - React 애플리케이션의 품질을 향상시키는 도구</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/til/">TIL</a> <a class="post-tag" href="/tags/today-i-leaned/">Today I Leaned</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/backend/">Backend</a> <a class="post-tag" href="/tags/kotlin/">Kotlin</a> <a class="post-tag" href="/tags/spring-boot/">Spring Boot</a> <a class="post-tag" href="/tags/frontend/">Frontend</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/nodejs/">NodeJS</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Angular-Interceptor-post/"><div class="card-body"> <span class="timeago small" > Jun 2, 2020 <i class="unloaded">2020-06-02T19:34:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Angular Interceptor로 로그인 상태 확인하기</h3><div class="text-muted small"><p> 사용자가 로그인을 성공했을 시 생성되는 Token 값을 이용해서 페이지 접근권한을 관리할 때 Interceptor라는 것을 사용한다고 들었습니다. 실제로는 localStorage에 저장한 token값을 사용하여 임시프로젝트를 수행했습니다. 나중에 Interceptor를 사용할 수도 있다고 생각되어서 코드 흐름을 파악하는 정도로만 기록해두려고 합니다. ...</p></div></div></a></div><div class="card"> <a href="/posts/NuxtWithVSCode-post/"><div class="card-body"> <span class="timeago small" > May 13, 2020 <i class="unloaded">2020-05-13T19:34:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Visual Studio Code로 NuxtJS 디버깅하기</h3><div class="text-muted small"><p> Visual Studio Code에서 Nuxt JS를 디버깅 할 수 있도록 환경설정을 해보겠습니다. 다른 Tool도 많지만, WebStorm에서는 코드 디버깅이 제대로 되지 않더라구요. 해결방법이 있는 것을 봤지만, VS는 기본적으로 vue와 nuxt코드를 이해했습니다. 집에서는 데스크탑과 MacOS를 사용하고 있었고, 회사에서는 데스크탑을 사용하고 ...</p></div></div></a></div><div class="card"> <a href="/posts/Nuxt-Config-post/"><div class="card-body"> <span class="timeago small" > Jul 1, 2020 <i class="unloaded">2020-07-01T19:34:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>NuxtJS 설치 밎 환경 구성</h3><div class="text-muted small"><p> Development Env. post date : 2020. 07. 01 OS : macOS Catalina 64bit, Windows 10 64bit Nodeserver : 1.0.0 NuxtJS : 2.13.2 NuxtJS 설치 NuxtJS - installation NodeJS가 설치되어 있다면, 아래 사...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Angular-Interceptor-post/" class="btn btn-outline-primary" prompt="Older"><p>Angular Interceptor로 로그인 상태 확인하기</p></a> <a href="/posts/Django-AWS-Setting-post/" class="btn btn-outline-primary" prompt="Newer"><p>AWS 환경설정 (django 배포해보기)</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//yeonseonam.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Angular Http 400 에러 처리하기 (Observabel 데이터 처리)'; this.page.url = 'https://yeonseo.github.io/posts/Angular-Observable-post/'; this.page.identifier = 'https://yeonseo.github.io/posts/Angular-Observable-post/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/yeonseo">남연서</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/til/">TIL</a> <a class="post-tag" href="/tags/today-i-leaned/">Today I Leaned</a> <a class="post-tag" href="/tags/web/">Web</a> <a class="post-tag" href="/tags/backend/">Backend</a> <a class="post-tag" href="/tags/kotlin/">Kotlin</a> <a class="post-tag" href="/tags/spring-boot/">Spring Boot</a> <a class="post-tag" href="/tags/frontend/">Frontend</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/nodejs/">NodeJS</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://yeonseo.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
